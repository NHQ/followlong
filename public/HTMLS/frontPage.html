<!doctype html>
<html>
  <head>
    <title></title>
    <style>
    #channels{float:right;width:250px;};
    #channels li{};
    #console{width:1200px;float:left;};
    #container{width:900px;background:green;}
    #admin{};
    .hidden{display:none};
    .showin{display:inline-block};
    </style>
    <link type="text/css" rel="stylesheet" href="/stylesheets/style.css" />
  </head>
  <body>
    <table width="500" id="mostmodernist" border="0"><tbody><tr><td><pre>
<span class="pigment">                                             .                                     .o8                                  o8o               .   </span>
<span class="pigment">                                           .o8                                    "888                                  `"'             .o8   </span>
<span class="pigment">    ooo. .oo.  .oo.    .ooooo.   .oooo.o .o888oo ooo. .oo.  .oo.    .ooooo.   .oooo888   .ooooo.  oooo d8b ooo. .oo.   oooo   .oooo.o .o888oo </span>
<span class="pigment">    `888P"Y88bP"Y88b  d88' `88b d88(  "8   888   `888P"Y88bP"Y88b  d88' `88b d88' `888  d88' `88b `888""8P `888P"Y88b  `888  d88(  "8   888   </span>
<span class="pigment">     888   888   888  888   888 `"Y88b.    888    888   888   888  888   888 888   888  888ooo888  888      888   888   888  `"Y88b.    888   </span>
<span class="pigment">     888   888   888  888   888 o.  )88b   888 .  888   888   888  888   888 888   888  888    .o  888      888   888   888  o.  )88b   888 . </span>
<span class="pigment">    o888o o888o o888o `Y8bod8P' 8""888P'   "888" o888o o888o o888o `Y8bod8P' `Y8bod88P" `Y8bod8P' d888b    o888o o888o o888o 8""888P'   "888" </span>



    </pre><!-- white text and background :) /!-->
    </td></tr></tbody></table>
  <a href="javascript:admin();" id="admin"><h1>ADMIN</h1></a>
  <div id="console">
    <ul id="channels">Channels:</ul>
    <h1 id="title"></h1>
    <ul id="container"></ul>
    <a href="javascript:window.navigator.registerContentHandler('application/vnd.mozilla.maybe.feed',
                                      'http://mostmodernist.no.de/2/#%s',
                                      'Mmmm');">click</a>
  </div>
  
  </body>
  <script type='text/javascript', src='/javascripts/jquery-1.5.1.min.js'></script>
  <script type='text/javascript', src='/javascripts/jquery.isotope.min.js'></script>
  <script type='text/javascript', src='/javascripts/path.min.js'></script>
   <script type='text/javascript'>  
  
  if (window.location.hash.pathname === '/newFeed')
    {
      $.post('./followFeed?feed='+window.location.hash.slice(1), function(answer){
        if (answer === "1")
        {
          followFeed(window.location.hash.slice(1))
        }
      })
    }
    
    function followfeed(feed){
       $('#container').empty();
        $('#container').load('./public/HTMLS/form.html');
    }
    
   var $container = $('ul#container');
   $container.isotope({
       itemSelector : 'li.articles',
   	  getSortData : {
   	    score : function ( $elem ) {
           return parseInt($elem.attr('data-score'));
         }
    	},
     layoutMode: 'fitRows',
     cellsByRow : {
       columnWidth : 800,
     	rowHeight: 100
     },
     animationOptions: {
       duration: 0,
       easing: 'none',
       queue: true
     },
     sortBy : 'score',
     sortAscending : false
   });
   
   var channy = $.getJSON('/userChannels', function(channels){
     console.log(channels);
       for (c in channels)
     	    {
     	      var channel = '<li class="channel data-filter="'+channels[c]+'"><h1>'+channels[c]+'</h1></a></li>';$channeling = $(channel);$('ul#channels').append($channeling);
     	    }
    }).error(function(jqXHR, textStatus, errorThrown) { alert("error: "+errorThrown); });

  var feedMe = $.getJSON('/init', function (feeds){
    console.log(feeds);
    $.each(feeds, function (k, v){
      var obj = new Object();
      obj.feed = k;
      var chans = JSON.parse(v);
      var channels = function (chans){var chanz="";for(i = 0;i< chan.length;++i){chanz += ( chans[i]+" ")};return chanz};
      $.getJSON('/getfeed?feed='+encodeURIComponent(k), function (content){
        console.log(content);
        for (c in content)
        var item = '<li class="article" data-feedName="'+content[c][1]+'" data-score="'+content[c][2]+'" data-channels="'+channels+'"><h1>'+content[c][0]+'</h1></a></li>';$appending = $(item);$container.isotope('insert', $appending);
      }).error(function(jqXHR, textStatus, errorThrown) { alert("error: "+errorThrown); })
    })
  }).error(function(jqXHR, textStatus, errorThrown) { alert("error: "+errorThrown); });

  function admin(){
    $('#container').empty();
    	    $('ul#channels li').css({'cursor':'pointer'});
    	    $('ul#channels li').click(function(event){
    	      event.preventDefault();
    	      var chan = $(this).attr('id');
    	      console.log(chan);
    	      infoChan(chan);
    	    })
  };
  function infoChan(chan){
    $.getJSON('/infoChan?chan='+chan, function(feeds){
       $('#container').empty();
      for (f in feeds)
      { 
        var food = '<a href="/" class="'+feeds[f][1]+'"><li>'+feeds[f][0]+'</li></a>';var $channeling = $(food);$('#container').append($channeling);
      }
      $('#container a').click(function(event){
        event.preventDefault();
        var feed = $(this).attr('class');
        infoFeed(feed);
      })
    });  
  };
  function infoFeed(feed){
    $.getJSON('/infoFeed?feed='+encodeURIComponent(feed), function (items){
      console.log(items);
      $('#container').empty();
      for (i = 0; i < items.length; i += 2)
      {
        var append = '<li class="articles" data-score="'+items[i+1]+'"><h2>"'+items[i]+'"</h2></li>';var $appending = $(append);$('#container').append($appending);
      }
    })
  };
  </script>
//what
</html>
